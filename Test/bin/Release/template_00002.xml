<?xml version="1.0" encoding="UTF-8" ?>
<report>
    <settings>
        <layout>LANDSCAPE</layout>
    
        <topmargin>30,0</topmargin>
        <bottommargin>20,0</bottommargin>
        <leftmargin>30,0</leftmargin>
        <rightmargin>20,0</rightmargin>
    
        <dataheaderborder>TOP,BOTTOM</dataheaderborder>
        <datafieldborder>NONE</datafieldborder>
        <groupheaderborder>NONE</groupheaderborder>
        <groupfooterborder>BOTTOM</groupfooterborder>
        
        <dataheadercolor>WHITE</dataheadercolor>
        <datafieldevencolor>WHITE</datafieldevencolor>
        <datafieldoddcolor>WHITE</datafieldoddcolor>
        <groupheadercolor>LIGHTGRAY</groupheadercolor>
        <groupfootercolor>LIGHTGRAY</groupfootercolor>
        
        <reportheaderfont>
            <family>HELVETICA</family>
            <bold>FALSE</bold>
            <italic>FALSE</italic>
            <size>8,0</size>
        </reportheaderfont>
        
        <reportfooterfont>
            <family>HELVETICA</family>
            <bold>FALSE</bold>
            <italic>FALSE</italic>
            <size>8,0</size>
        </reportfooterfont>
        
        <dataheaderfont>
            <family>HELVETICA</family>
            <bold>FALSE</bold>
            <italic>FALSE</italic>
            <size>8,0</size>
        </dataheaderfont>
        
        <datafieldfont>
            <family>HELVETICA</family>
            <bold>FALSE</bold>
            <italic>FALSE</italic>
            <size>7,0</size>
        </datafieldfont>
        
        <groupheaderfont>
            <family>HELVETICA</family>
            <bold>TRUE</bold>
            <italic>FALSE</italic>
            <size>7,0</size>
        </groupheaderfont>
        
        <groupfooterfont>
            <family>HELVETICA</family>
            <bold>TRUE</bold>
            <italic>FALSE</italic>
            <size>7,0</size>
        </groupfooterfont>
    </settings>

    <command>
        <sql>
            select to_char(t.inst_in_codigo) as inst_in_codigo,
                   to_char(t.agente) as agente,
                   to_char(t.agn_st_nome) as agn_st_nome,
                   to_char(t.pais_st_nome) as pais_st_nome,
                   to_char(t.nota) as nota,
                   to_char(t.sai_st_serie) as sai_st_serie,
                   to_char(t.data, 'dd/mm/yyyy') as data,
                   to_char(t.cfop) as cfop,
                   to_char(t.sai_st_de) as sai_st_de,
                   to_char(t.produto) as produto,
                   'Produto: ' || to_char(t.produto) || ' - ' || to_char(t.pro_st_descricao) as pro_st_descricao,
                   to_char(t.pro_st_unidade) as pro_st_unidade,
                   to_char(t.pro_st_ncm) as pro_st_ncm,
                   to_char(t.sai_re_quantidade) as sai_re_quantidade,
                   to_char(t.sai_re_valor) as sai_re_valor,
                   to_char(t.sai_re_desconto) as sai_re_desconto,
                   to_char(t.sai_re_comissoes) as sai_re_comissoes,
                   to_char(t.sai_re_juros) as sai_re_juros,
                   to_char(t.sai_re_ipi) as sai_re_ipi,
                   to_char(t.sai_re_pis) as sai_re_pis,
                   to_char(t.sai_re_cofins) as sai_re_cofins,
                   to_char(t.sai_re_icms) as sai_re_icms,
                   to_char(t.sai_re_icmsst) as sai_re_icmsst,
                   to_char(t.sai_re_valorliquido) as sai_re_valorliquido,
                   to_char(t.grupo) as grupo,
                   to_char(t.paraisofiscal) as paraisofiscal,
                   to_char(t.cfop_bo_calculo) as cfop_bo_calculo,
                   to_char(gp.produto_valor) as produto_valor,
                   to_char(gp.produto_desconto) as produto_desconto,
                   to_char(gp.produto_comissoes) as produto_comissoes,
                   to_char(gp.produto_juros) as produto_juros,
                   to_char(gp.produto_ipi) as produto_ipi,
                   to_char(gp.produto_pis) as produto_pis,
                   to_char(gp.produto_cofins) as produto_cofins,
                   to_char(gp.produto_icms) as produto_icms,
                   to_char(gp.produto_icmsst) as produto_icmsst,
                   to_char(gp.produto_liquido) as produto_liquido,
                   to_char(gg.geral_valor) as geral_valor,
                   to_char(gg.geral_desconto) as geral_desconto,
                   to_char(gg.geral_comissoes) as geral_comissoes,
                   to_char(gg.geral_juros) as geral_juros,
                   to_char(gg.geral_ipi) as geral_ipi,
                   to_char(gg.geral_pis) as geral_pis,
                   to_char(gg.geral_cofins) as geral_cofins,
                   to_char(gg.geral_icms) as geral_icms,
                   to_char(gg.geral_icmsst) as geral_icmsst,
                   to_char(gg.geral_liquido) as geral_liquido,
                   #CABECALHO#
            from tab00002 t,
            (
            select produto as produto_id,
                   sum(sai_re_valor) as produto_valor,
                   sum(sai_re_desconto) as produto_desconto,
                   sum(sai_re_comissoes) as produto_comissoes,
                   sum(sai_re_juros) as produto_juros,
                   sum(sai_re_ipi) as produto_ipi,
                   sum(sai_re_pis) as produto_pis,
                   sum(sai_re_cofins) as produto_cofins,
                   sum(sai_re_icms) as produto_icms,
                   sum(sai_re_icmsst) as produto_icmsst,
                   sum(sai_re_valorliquido) as produto_liquido
            from tab00002
            where 1 = 1
              #FILTRO#
            group by produto
            ) gp,
            (
            select sum(sai_re_valor) as geral_valor,
                   sum(sai_re_desconto) as geral_desconto,
                   sum(sai_re_comissoes) as geral_comissoes,
                   sum(sai_re_juros) as geral_juros,
                   sum(sai_re_ipi) as geral_ipi,
                   sum(sai_re_pis) as geral_pis,
                   sum(sai_re_cofins) as geral_cofins,
                   sum(sai_re_icms) as geral_icms,
                   sum(sai_re_icmsst) as geral_icmsst,
                   sum(sai_re_valorliquido) as geral_liquido
            from tab00002
            where 1 = 1
              #FILTRO#
            ) gg
            where t.produto = gp.produto_id
              #FILTRO#
        </sql>
        <parameters>
            <parameter>
                <name>CABECALHO</name>
                <type>UNDEFINED</type>
            </parameter>
            <parameter>
                <name>FILTRO</name>
                <type>UNDEFINED</type>
            </parameter>
        </parameters>
    </command>

    <header>
        <height>50,0</height>
        <object>
            <type>IMAGE</type>
            <column>imagem</column>
            <posx>0,0</posx>
            <posy>0,0</posy>
            <align>LEFT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>empresa</column>
            <posx>180,0</posx>
            <posy>5,0</posy>
            <align>LEFT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>ano</column>
            <posx>0,0</posx>
            <posy>5,0</posy>
            <align>RIGHT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>titulo</column>
            <posx>180,0</posx>
            <posy>22,0</posy>
            <align>LEFT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>emissao</column>
            <posx>0,0</posx>
            <posy>22,0</posy>
            <align>RIGHT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>subtitulo</column>
            <posx>180,0</posx>
            <posy>40,0</posy>
            <align>LEFT</align>
        </object>
        <object>
            <type>PAGENUMBER</type>
            <column></column>
            <posx>0,0</posx>
            <posy>40,0</posy>
            <align>RIGHT</align>
        </object>
    </header>

    <footer>
        <height>20,0</height>
        <object>
            <type>TEXT</type>
            <column>sistema</column>
            <posx>0,0</posx>
            <posy>15,0</posy>
            <align>LEFT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>usuario</column>
            <posx>0,0</posx>
            <posy>15,0</posy>
            <align>RIGHT</align>
        </object>
    </footer>

    <fields>
        <field>
            <title>Código</title>
            <column>agente</column>
            <align>LEFT</align>
            <fill>5</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Cliente</title>
            <column>agn_st_nome</column>
            <align>LEFT</align>
            <fill>6</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>País</title>
            <column>pais_st_nome</column>
            <align>LEFT</align>
            <fill>5</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Ser</title>
            <column>sai_st_serie</column>
            <align>CENTER</align>
            <fill>3</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Nota</title>
            <column>nota</column>
            <align>CENTER</align>
            <fill>4</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Emissao</title>
            <column>data</column>
            <align>CENTER</align>
            <fill>5</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Nat.</title>
            <column>cfop</column>
            <align>CENTER</align>
            <fill>3</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Qtde</title>
            <column>sai_re_quantidade</column>
            <align>RIGHT</align>
            <fill>6</fill>
            <type>REAL</type>
        </field>
        <field>
            <title>Un.</title>
            <column>pro_st_unidade</column>
            <align>CENTER</align>
            <fill>3</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Valor</title>
            <column>sai_re_valor</column>
            <align>RIGHT</align>
            <fill>6</fill>
            <type>REAL</type>
        </field>
        <field>
            <title>Desconto</title>
            <column>sai_re_desconto</column>
            <align>RIGHT</align>
            <fill>6</fill>
            <type>REAL</type>
        </field>
        <field>
            <title>Comissoes</title>
            <column>sai_re_comissoes</column>
            <align>RIGHT</align>
            <fill>6</fill>
            <type>REAL</type>
        </field>
        <field>
            <title>Juros</title>
            <column>sai_re_juros</column>
            <align>RIGHT</align>
            <fill>6</fill>
            <type>REAL</type>
        </field>
        <field>
            <title>IPI</title>
            <column>sai_re_ipi</column>
            <align>RIGHT</align>
            <fill>6</fill>
            <type>REAL</type>
        </field>
        <field>
            <title>PIS</title>
            <column>sai_re_pis</column>
            <align>RIGHT</align>
            <fill>6</fill>
            <type>REAL</type>
        </field>
        <field>
            <title>COFINS</title>
            <column>sai_re_cofins</column>
            <align>RIGHT</align>
            <fill>6</fill>
            <type>REAL</type>
        </field>
        <field>
            <title>ICMS</title>
            <column>sai_re_icms</column>
            <align>RIGHT</align>
            <fill>6</fill>
            <type>REAL</type>
        </field>
        <field>
            <title>ICMS ST</title>
            <column>sai_re_icmsst</column>
            <align>RIGHT</align>
            <fill>6</fill>
            <type>REAL</type>
        </field>
        <field>
            <title>Liquido</title>
            <column>sai_re_valorliquido</column>
            <align>RIGHT</align>
            <fill>6</fill>
            <type>REAL</type>
        </field>
    </fields>

    <groups>
        <group>
            <level>0</level>
            <column>produto</column>
            <sort>data asc, nota asc</sort>
            
            <showheader>TRUE</showheader>
            <headerfields>
                <headerfield>
                    <title></title>
                    <column>pro_st_descricao</column>
                    <align>LEFT</align>
                    <fill>100</fill>
                    <type>STRING</type>
                </headerfield>
            </headerfields>
            
            <showfooter>TRUE</showfooter>
            <footerfields>
                <footerfield>
                    <title></title>
                    <column></column>
                    <align>LEFT</align>
                    <fill>40</fill>
                    <type>STRING</type>
                </footerfield>
                <footerfield>
                    <title>Valor</title>
                    <column>produto_valor</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>Desconto</title>
                    <column>produto_desconto</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>Comissoes</title>
                    <column>produto_comissoes</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>Juros</title>
                    <column>produto_juros</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>IPI</title>
                    <column>produto_ipi</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>PIS</title>
                    <column>produto_pis</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>COFINS</title>
                    <column>produto_cofins</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>ICMS</title>
                    <column>produto_icms</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>ICMS ST</title>
                    <column>produto_icmsst</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>Liquido</title>
                    <column>produto_liquido</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
            </footerfields>
        </group>
        
        <group>
            <level>1</level>
            <column>titulo</column>
            <sort>titulo asc</sort>
            
            <showheader>FALSE</showheader>
            
            <showfooter>TRUE</showfooter>
            <footerfields>
                <footerfield>
                    <title></title>
                    <column></column>
                    <align>LEFT</align>
                    <fill>40</fill>
                    <type>STRING</type>
                </footerfield>
                <footerfield>
                    <title>Valor</title>
                    <column>geral_valor</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>Desconto</title>
                    <column>geral_desconto</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>Comissoes</title>
                    <column>geral_comissoes</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>Juros</title>
                    <column>geral_juros</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>IPI</title>
                    <column>geral_ipi</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>PIS</title>
                    <column>geral_pis</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>COFINS</title>
                    <column>geral_cofins</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>ICMS</title>
                    <column>geral_icms</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>ICMS ST</title>
                    <column>geral_icmsst</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
                <footerfield>
                    <title>Liquido</title>
                    <column>geral_liquido</column>
                    <align>RIGHT</align>
                    <fill>6</fill>
                    <type>REAL</type>
                </footerfield>
            </footerfields>
        </group>
    </groups>

</report>
