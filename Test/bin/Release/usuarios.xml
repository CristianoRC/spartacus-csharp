<?xml version="1.0" encoding="UTF-8" ?>
<report>

    <connection>
        <type>odbc</type>
        <provider></provider>
        <host></host>
        <port></port>
        <service>planner</service>
        <user>psinfo</user>
        <password>plaservinfo</password>
    </connection>

    <settings>
        <layout>LANDSCAPE</layout>
    
        <topmargin>30,0</topmargin>
        <bottommargin>20,0</bottommargin>
        <leftmargin>30,0</leftmargin>
        <rightmargin>20,0</rightmargin>
    
        <dataheaderborder>TOP,BOTTOM</dataheaderborder>
        <datafieldborder>NONE</datafieldborder>
        <groupheaderborder>NONE</groupheaderborder>
        <groupfooterborder>BOTTOM</groupfooterborder>
        
        <dataheadercolor>WHITE</dataheadercolor>
        <datafieldevencolor>WHITE</datafieldevencolor>
        <datafieldoddcolor>WHITE</datafieldoddcolor>
        <groupheadercolor>LIGHTGRAY</groupheadercolor>
        <groupfootercolor>LIGHTGRAY</groupfootercolor>
        
        <reportheaderfont>
            <family>HELVETICA</family>
            <bold>FALSE</bold>
            <italic>TRUE</italic>
            <size>8,0</size>
        </reportheaderfont>
        
        <reportfooterfont>
            <family>HELVETICA</family>
            <bold>FALSE</bold>
            <italic>TRUE</italic>
            <size>8,0</size>
        </reportfooterfont>
        
        <dataheaderfont>
            <family>HELVETICA</family>
            <bold>FALSE</bold>
            <italic>FALSE</italic>
            <size>8,0</size>
        </dataheaderfont>
        
        <datafieldfont>
            <family>HELVETICA</family>
            <bold>FALSE</bold>
            <italic>FALSE</italic>
            <size>7,0</size>
        </datafieldfont>
        
        <groupheaderfont>
            <family>HELVETICA</family>
            <bold>TRUE</bold>
            <italic>FALSE</italic>
            <size>7,0</size>
        </groupheaderfont>
        
        <groupfooterfont>
            <family>HELVETICA</family>
            <bold>TRUE</bold>
            <italic>FALSE</italic>
            <size>7,0</size>
        </groupfooterfont>
    </settings>

    <command>
        <sql>
            select 'Lista de Usuarios' as titulo,
                   'Por Empresa' as subtitulo,
                   emp_st_nome as empresa,
                   'Ano: 2014' as ano,
                   'logops.png' as imagem,
                   'Usuario: Rafael Thofehrn Castro' as usuario,
                   'Sistema: Planner v0.7.0 - Modulo de Relatorios v1' as sistema,
                   'Emissao: ' || to_char(sysdate, 'dd/mm/yyyy hh24:mi:ss') as emissao,
				   
            	   u.usu_in_codigo,
			       u.emp_in_codigo,
			       'empresa' as emp_st_nome,
			       p.perf_st_nome,
			       u.usu_st_login,
			       u.usu_st_nome,
			       u.usu_st_cargo,
			       u.usu_st_dddtelefone,
			       u.usu_st_telefone,
			       u.usu_st_ramal,
			       u.usu_st_email,
			       'Numero total de usuarios: ' || geral.totalgeral as totalgeral,
			       'Numero de usuarios: ' || por_empresa.total as total
			from usuarios u, perfis p,
			    (select count(*) total, usu.emp_in_codigo
			    from usuarios usu
			    group by usu.emp_in_codigo) por_empresa,
			    (select count(*) totalgeral
			    from usuarios usu) geral,
			    empresas e
			where u.emp_in_codigo = por_empresa.emp_in_codigo
				  and u.emp_in_codigo = e.emp_in_codigo
				  and u.perf_in_codigo = p.perf_in_codigo
        </sql>
        <parameters>
            <parameter>
                <name>EMID</name>
                <type>INTEGER</type>
            </parameter>
            <parameter>
                <name>ANO</name>
                <type>INTEGER</type>
            </parameter>
        </parameters>
    </command>

    <header>
        <height>50,0</height>
        <object>
            <type>IMAGE</type>
            <column>imagem</column>
            <posx>0,0</posx>
            <posy>0,0</posy>
            <align>LEFT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>empresa</column>
            <posx>85,0</posx>
            <posy>5,0</posy>
            <align>LEFT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>ano</column>
            <posx>0,0</posx>
            <posy>5,0</posy>
            <align>RIGHT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>titulo</column>
            <posx>85,0</posx>
            <posy>22,0</posy>
            <align>LEFT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>emissao</column>
            <posx>0,0</posx>
            <posy>22,0</posy>
            <align>RIGHT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>subtitulo</column>
            <posx>85,0</posx>
            <posy>40,0</posy>
            <align>LEFT</align>
        </object>
        <object>
            <type>PAGENUMBER</type>
            <column></column>
            <posx>0,0</posx>
            <posy>40,0</posy>
            <align>RIGHT</align>
        </object>
    </header>

    <footer>
        <height>20,0</height>
        <object>
            <type>TEXT</type>
            <column>sistema</column>
            <posx>0,0</posx>
            <posy>15,0</posy>
            <align>LEFT</align>
        </object>
        <object>
            <type>TEXT</type>
            <column>usuario</column>
            <posx>0,0</posx>
            <posy>15,0</posy>
            <align>RIGHT</align>
        </object>
    </footer>

    <fields>
        <field>
            <title>CÃ³digo</title>
            <column>usu_in_codigo</column>
            <align>LEFT</align>
            <fill>5</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Perfil</title>
            <column>perf_st_nome</column>
            <align>LEFT</align>
            <fill>8</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Login</title>
            <column>usu_st_login</column>
            <align>CENTER</align>
            <fill>8</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Nome</title>
            <column>usu_st_nome</column>
            <align>CENTER</align>
            <fill>27</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Cargo</title>
            <column>usu_st_cargo</column>
            <align>CENTER</align>
            <fill>8</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>DDD</title>
            <column>usu_st_dddtelefone</column>
            <align>CENTER</align>
            <fill>8</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Telefone</title>
            <column>usu_st_telefone</column>
            <align>RIGHT</align>
            <fill>8</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Ramal</title>
            <column>usu_st_ramal</column>
            <align>RIGHT</align>
            <fill>8</fill>
            <type>STRING</type>
        </field>
        <field>
            <title>Email</title>
            <column>usu_st_email</column>
            <align>RIGHT</align>
            <fill>20</fill>
            <type>STRING</type>
        </field>
    </fields>

    <groups>
        <group>
            <level>0</level>
            <column>emp_in_codigo</column>
            <sort>usu_st_login asc</sort>
            
            <showheader>TRUE</showheader>
            <headerfields>
                <headerfield>
                    <title></title>
                    <column>empresa</column>
                    <align>LEFT</align>
                    <fill>100</fill>
                    <type>STRING</type>
                </headerfield>
            </headerfields>
            
            <showfooter>TRUE</showfooter>
            <footerfields>
                <footerfield>
                    <title></title>
                    <column></column>
                    <align>LEFT</align>
                    <fill>80</fill>
                    <type>STRING</type>
                </footerfield>
                <footerfield>
                    <title>Numero de Usuarios</title>
                    <column>total</column>
                    <align>RIGHT</align>
                    <fill>20</fill>
                    <type>STRING</type>
                </footerfield>
            </footerfields>
        </group>
        
        <group>
            <level>1</level>
            <column>titulo</column>
            <sort>titulo asc</sort>
            
            <showheader>FALSE</showheader>
            
            <showfooter>TRUE</showfooter>
            <footerfields>
                <footerfield>
                    <title></title>
                    <column></column>
                    <align>LEFT</align>
                    <fill>80</fill>
                    <type>STRING</type>
                </footerfield>
                <footerfield>
                    <title>Total Geral</title>
                    <column>totalgeral</column>
                    <align>RIGHT</align>
                    <fill>20</fill>
                    <type>STRING</type>
                </footerfield>
            </footerfields>
        </group>
    </groups>

</report>
